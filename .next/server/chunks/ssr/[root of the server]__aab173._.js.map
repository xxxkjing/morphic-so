{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["/turbopack/[next]/internal/font/google/inter_95e1d3b3.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_export_value__({\n  \"className\": \"inter_95e1d3b3-module__jTJ6xG__className\",\n  \"variable\": \"inter_95e1d3b3-module__jTJ6xG__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 8, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["/turbopack/[next]/internal/font/google/inter_95e1d3b3.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.tsx%22,%22import%22:%22Inter%22,%22arguments%22:[{%22subsets%22:[%22latin%22],%22variable%22:%22--font-sans%22}],%22variableName%22:%22fontSans%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'__Inter_95e1d3', '__Inter_Fallback_95e1d3'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;;;AACA,MAAM,WAAW;IACb,WAAW,qJAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,qJAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,qJAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/utils/index.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\nimport { createOllama } from 'ollama-ai-provider'\nimport { createOpenAI } from '@ai-sdk/openai'\nimport { google } from '@ai-sdk/google'\nimport { anthropic } from '@ai-sdk/anthropic'\nimport { CoreMessage } from 'ai'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function getModel(useSubModel = false) {\n  const ollamaBaseUrl = process.env.OLLAMA_BASE_URL + '/api'\n  const ollamaModel = process.env.OLLAMA_MODEL\n  const ollamaSubModel = process.env.OLLAMA_SUB_MODEL\n  const openaiApiBase = process.env.OPENAI_API_BASE\n  const openaiApiKey = process.env.OPENAI_API_KEY\n  let openaiApiModel = process.env.OPENAI_API_MODEL || 'gpt-4o'\n  const googleApiKey = process.env.GOOGLE_GENERATIVE_AI_API_KEY\n  const anthropicApiKey = process.env.ANTHROPIC_API_KEY\n\n  if (\n    !(ollamaBaseUrl && ollamaModel) &&\n    !openaiApiKey &&\n    !googleApiKey &&\n    !anthropicApiKey\n  ) {\n    throw new Error(\n      'Missing environment variables for Ollama, OpenAI, Google or Anthropic'\n    )\n  }\n  // Ollama\n  if (ollamaBaseUrl && ollamaModel) {\n    const ollama = createOllama({ baseURL: ollamaBaseUrl })\n\n    if (useSubModel && ollamaSubModel) {\n      return ollama(ollamaSubModel)\n    }\n\n    return ollama(ollamaModel)\n  }\n\n  if (googleApiKey) {\n    return google('models/gemini-2.5-flash')\n  }\n\n  if (anthropicApiKey) {\n    return anthropic('claude-3-5-sonnet-20240620')\n  }\n\n  // Fallback to OpenAI instead\n\n  const openai = createOpenAI({\n    baseURL: openaiApiBase, // optional base URL for proxies etc.\n    apiKey: openaiApiKey, // optional API key, default to env property OPENAI_API_KEY\n    organization: '' // optional organization\n  })\n\n  return openai.chat(openaiApiModel)\n}\n\n/**\n * Takes an array of AIMessage and modifies each message where the role is 'tool'.\n * Changes the role to 'assistant' and converts the content to a JSON string.\n * Returns the modified messages as an array of CoreMessage.\n *\n * @param aiMessages - Array of AIMessage\n * @returns modifiedMessages - Array of modified messages\n */\nexport function transformToolMessages(messages: CoreMessage[]): CoreMessage[] {\n  return messages.map(message =>\n    message.role === 'tool'\n      ? {\n          ...message,\n          role: 'assistant',\n          content: JSON.stringify(message.content),\n          type: 'tool'\n        }\n      : message\n  ) as CoreMessage[]\n}\n\n/**\n * Sanitizes a URL by replacing spaces with '%20'\n * @param url - The URL to sanitize\n * @returns The sanitized URL\n */\nexport function sanitizeUrl(url: string): string {\n  return url.replace(/\\s+/g, '%20')\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAQO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB;AAEO,SAAS,SAAS,cAAc,KAAK;IAC1C,MAAM,gBAAgB,QAAQ,GAAG,CAAC,eAAe,GAAG;IACpD,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;IAC5C,MAAM,iBAAiB,QAAQ,GAAG,CAAC,gBAAgB;IACnD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,eAAe;IACjD,MAAM,eAAe,QAAQ,GAAG,CAAC,cAAc;IAC/C,IAAI,iBAAiB,QAAQ,GAAG,CAAC,gBAAgB,IAAI;IACrD,MAAM,eAAe,QAAQ,GAAG,CAAC,4BAA4B;IAC7D,MAAM,kBAAkB,QAAQ,GAAG,CAAC,iBAAiB;IAErD,IACE,CAAC,CAAC,iBAAiB,WAAW,KAC9B,CAAC,gBACD,CAAC,gBACD,CAAC,iBACD;QACA,MAAM,IAAI,MACR;IAEJ;IACA,SAAS;IACT,IAAI,iBAAiB,aAAa;QAChC,MAAM,SAAS,CAAA,GAAA,0JAAA,CAAA,eAAY,AAAD,EAAE;YAAE,SAAS;QAAc;QAErD,IAAI,eAAe,gBAAgB;YACjC,OAAO,OAAO;QAChB;QAEA,OAAO,OAAO;IAChB;IAEA,IAAI,cAAc;QAChB,OAAO,CAAA,GAAA,uJAAA,CAAA,SAAM,AAAD,EAAE;IAChB;IAEA,IAAI,iBAAiB;QACnB,OAAO,CAAA,GAAA,0JAAA,CAAA,YAAS,AAAD,EAAE;IACnB;IAEA,6BAA6B;IAE7B,MAAM,SAAS,CAAA,GAAA,uJAAA,CAAA,eAAY,AAAD,EAAE;QAC1B,SAAS;QACT,QAAQ;QACR,cAAc,GAAG,wBAAwB;IAC3C;IAEA,OAAO,OAAO,IAAI,CAAC;AACrB;AAUO,SAAS,sBAAsB,QAAuB;IAC3D,OAAO,SAAS,GAAG,CAAC,CAAA,UAClB,QAAQ,IAAI,KAAK,SACb;YACE,GAAG,OAAO;YACV,MAAM;YACN,SAAS,KAAK,SAAS,CAAC,QAAQ,OAAO;YACvC,MAAM;QACR,IACA;AAER;AAOO,SAAS,YAAY,GAAW;IACrC,OAAO,IAAI,OAAO,CAAC,QAAQ;AAC7B"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/theme-provider.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ThemeProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/theme-provider.tsx\",\n    \"ThemeProvider\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/mode-toggle.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ModeToggle = registerClientReference(\n    function() { throw new Error(\"Attempted to call ModeToggle() from the server but ModeToggle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/mode-toggle.tsx\",\n    \"ModeToggle\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,aAAa,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,wCACA"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 147, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/header.tsx"],"sourcesContent":["import React from 'react'\nimport { ModeToggle } from './mode-toggle'\n\nexport const Header: React.FC = async () => {\n  return (\n    <header className=\"fixed w-full p-1 md:p-2 flex justify-between items-center z-10 backdrop-blur md:backdrop-blur-none bg-background/80 md:bg-transparent\">\n      <div>\n        <a href=\"/\">\n          <span className=\"sr-only\">Search</span>\n        </a>\n      </div>\n      <div className=\"flex gap-0.5\">\n        <ModeToggle />\n      </div>\n    </header>\n  )\n}\n\nexport default Header\n"],"names":[],"mappings":";;;;;;;;;AAGO,MAAM,SAAmB;IAC9B,qBACE,wPAAC;QAAO,WAAU;;0BAChB,wPAAC;0BACC,cAAA,wPAAC;oBAAE,MAAK;8BACN,cAAA,wPAAC;wBAAK,WAAU;kCAAU;;;;;;;;;;;;;;;;0BAG9B,wPAAC;gBAAI,WAAU;0BACb,cAAA,wPAAC,6HAAA,CAAA,aAAU;;;;;;;;;;;;;;;;AAInB;uCAEe"}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/footer.tsx"],"sourcesContent":["import React from 'react'\n\nconst Footer: React.FC = () => {\n  return (\n    <footer className=\"w-fit p-1 md:p-2 fixed bottom-0 right-0\">\n    </footer>\n  )\n}\n\nexport default Footer\n"],"names":[],"mappings":";;;;;;AAEA,MAAM,SAAmB;IACvB,qBACE,wPAAC;QAAO,WAAU;;;;;;AAGtB;uCAEe"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/ui/sonner.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Toaster = registerClientReference(\n    function() { throw new Error(\"Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/ui/sonner.tsx\",\n    \"Toaster\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,UAAU,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,sCACA"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 251, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 261, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/utils/app-state.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AppStateProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AppStateProvider() from the server but AppStateProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/lib/utils/app-state.tsx\",\n    \"AppStateProvider\",\n);\nexport const useAppState = registerClientReference(\n    function() { throw new Error(\"Attempted to call useAppState() from the server but useAppState is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/lib/utils/app-state.tsx\",\n    \"useAppState\",\n);\n"],"names":[],"mappings":";;;;;;;AACO,MAAM,mBAAmB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAClD;IAAa,MAAM,IAAI,MAAM;AAAgP,GAC7Q,qCACA;AAEG,MAAM,cAAc,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,qCACA"}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/layout.tsx"],"sourcesContent":["import type { Metadata, Viewport } from 'next'\nimport { Inter as FontSans } from 'next/font/google'\nimport './globals.css'\nimport { cn } from '@/lib/utils'\nimport { ThemeProvider } from '@/components/theme-provider'\nimport Header from '@/components/header'\nimport Footer from '@/components/footer'\nimport { Toaster } from '@/components/ui/sonner'\nimport { AppStateProvider } from '@/lib/utils/app-state'\n\nconst fontSans = FontSans({\n  subsets: ['latin'],\n  variable: '--font-sans'\n})\n\nconst title = 'Search'\nconst description =\n  'A fully open-source AI-powered answer engine with a generative UI.'\n\nexport const metadata: Metadata = {\n  metadataBase: new URL('https://so.shfu.cn'),\n  title,\n  description,\n  openGraph: {\n    title,\n    description\n  },\n  twitter: {\n    title,\n    description,\n    card: 'summary_large_image',\n    creator: '@miiura'\n  }\n}\n\nexport const viewport: Viewport = {\n  width: 'device-width',\n  initialScale: 1,\n  minimumScale: 1,\n  maximumScale: 1\n}\n\nexport default function RootLayout({\n  children\n}: Readonly<{\n  children: React.ReactNode\n}>) {\n  return (\n    <html lang=\"en\" suppressHydrationWarning>\n      <body className={cn('font-sans antialiased', fontSans.variable)}>\n        <ThemeProvider\n          attribute=\"class\"\n          defaultTheme=\"system\"\n          enableSystem\n          disableTransitionOnChange\n        >\n          <AppStateProvider>\n            <Header />\n            {children}\n            <Footer />\n            <Toaster />\n          </AppStateProvider>\n        </ThemeProvider>\n      </body>\n    </html>\n  )\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAeA,MAAM,QAAQ;AACd,MAAM,cACJ;AAEK,MAAM,WAAqB;IAChC,cAAc,IAAI,IAAI;IACtB;IACA;IACA,WAAW;QACT;QACA;IACF;IACA,SAAS;QACP;QACA;QACA,MAAM;QACN,SAAS;IACX;AACF;AAEO,MAAM,WAAqB;IAChC,OAAO;IACP,cAAc;IACd,cAAc;IACd,cAAc;AAChB;AAEe,SAAS,WAAW,EACjC,QAAQ,EAGR;IACA,qBACE,wPAAC;QAAK,MAAK;QAAK,wBAAwB;kBACtC,cAAA,wPAAC;YAAK,WAAW,CAAA,GAAA,qHAAA,CAAA,KAAE,AAAD,EAAE,yBAAyB,yIAAA,CAAA,UAAQ,CAAC,QAAQ;sBAC5D,cAAA,wPAAC,gIAAA,CAAA,gBAAa;gBACZ,WAAU;gBACV,cAAa;gBACb,YAAY;gBACZ,yBAAyB;0BAEzB,cAAA,wPAAC,6HAAA,CAAA,mBAAgB;;sCACf,wPAAC,qHAAA,CAAA,UAAM;;;;;wBACN;sCACD,wPAAC,qHAAA,CAAA,UAAM;;;;;sCACP,wPAAC,2HAAA,CAAA,UAAO;;;;;;;;;;;;;;;;;;;;;;;;;;AAMpB"}},
    {"offset": {"line": 386, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/chat.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Chat = registerClientReference(\n    function() { throw new Error(\"Attempted to call Chat() from the server but Chat is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/chat.tsx\",\n    \"Chat\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,OAAO,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACtC;IAAa,MAAM,IAAI,MAAM;AAAwN,GACrP,iCACA"}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 412, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/actions/chat.ts"],"sourcesContent":["'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\nimport { type Chat } from '@/lib/types'\nimport { Redis } from '@upstash/redis'\n\nconst redis = new Redis({\n  url: process.env.UPSTASH_REDIS_REST_URL || '',\n  token: process.env.UPSTASH_REDIS_REST_TOKEN || ''\n})\n\nexport async function getChats(userId?: string | null) {\n  if (!userId) {\n    return []\n  }\n\n  try {\n    const pipeline = redis.pipeline()\n    const chats: string[] = await redis.zrange(`user:chat:${userId}`, 0, -1, {\n      rev: true\n    })\n\n    for (const chat of chats) {\n      pipeline.hgetall(chat)\n    }\n\n    const results = await pipeline.exec()\n\n    return results as Chat[]\n  } catch (error) {\n    return []\n  }\n}\n\nexport async function getChat(id: string, userId: string = 'anonymous') {\n  const chat = await redis.hgetall<Chat>(`chat:${id}`)\n\n  if (!chat) {\n    return null\n  }\n\n  return chat\n}\n\nexport async function clearChats(\n  userId: string = 'anonymous'\n): Promise<{ error?: string }> {\n  const chats: string[] = await redis.zrange(`user:chat:${userId}`, 0, -1)\n  if (!chats.length) {\n    return { error: 'No chats to clear' }\n  }\n  const pipeline = redis.pipeline()\n\n  for (const chat of chats) {\n    pipeline.del(chat)\n    pipeline.zrem(`user:chat:${userId}`, chat)\n  }\n\n  await pipeline.exec()\n\n  revalidatePath('/')\n  redirect('/')\n}\n\nexport async function saveChat(chat: Chat, userId: string = 'anonymous') {\n  const pipeline = redis.pipeline()\n  pipeline.hmset(`chat:${chat.id}`, chat)\n  pipeline.zadd(`user:chat:${chat.userId}`, {\n    score: Date.now(),\n    member: `chat:${chat.id}`\n  })\n  await pipeline.exec()\n}\n\nexport async function getSharedChat(id: string) {\n  const chat = await redis.hgetall<Chat>(`chat:${id}`)\n\n  if (!chat || !chat.sharePath) {\n    return null\n  }\n\n  return chat\n}\n\nexport async function shareChat(id: string, userId: string = 'anonymous') {\n  const chat = await redis.hgetall<Chat>(`chat:${id}`)\n\n  if (!chat || chat.userId !== userId) {\n    return null\n  }\n\n  const payload = {\n    ...chat,\n    sharePath: `/share/${id}`\n  }\n\n  await redis.hmset(`chat:${id}`, payload)\n\n  return payload\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAOA,MAAM,QAAQ,IAAI,6JAAA,CAAA,QAAK,CAAC;IACtB,KAAK,QAAQ,GAAG,CAAC,sBAAsB,IAAI;IAC3C,OAAO,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AACjD;AAEO,eAAe,SAAS,MAAsB;IACnD,IAAI,CAAC,QAAQ;QACX,OAAO,EAAE;IACX;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ;QAC/B,MAAM,QAAkB,MAAM,MAAM,MAAM,CAAC,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,GAAG,CAAC,GAAG;YACvE,KAAK;QACP;QAEA,KAAK,MAAM,QAAQ,MAAO;YACxB,SAAS,OAAO,CAAC;QACnB;QAEA,MAAM,UAAU,MAAM,SAAS,IAAI;QAEnC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO,EAAE;IACX;AACF;AAEO,eAAe,QAAQ,EAAU,EAAE,SAAiB,WAAW;IACpE,MAAM,OAAO,MAAM,MAAM,OAAO,CAAO,CAAC,KAAK,EAAE,GAAG,CAAC;IAEnD,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe,WACpB,SAAiB,WAAW;IAE5B,MAAM,QAAkB,MAAM,MAAM,MAAM,CAAC,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE,GAAG,CAAC;IACtE,IAAI,CAAC,MAAM,MAAM,EAAE;QACjB,OAAO;YAAE,OAAO;QAAoB;IACtC;IACA,MAAM,WAAW,MAAM,QAAQ;IAE/B,KAAK,MAAM,QAAQ,MAAO;QACxB,SAAS,GAAG,CAAC;QACb,SAAS,IAAI,CAAC,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE;IACvC;IAEA,MAAM,SAAS,IAAI;IAEnB,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;IACf,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;AACX;AAEO,eAAe,SAAS,IAAU,EAAE,SAAiB,WAAW;IACrE,MAAM,WAAW,MAAM,QAAQ;IAC/B,SAAS,KAAK,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE;IAClC,SAAS,IAAI,CAAC,CAAC,UAAU,EAAE,KAAK,MAAM,CAAC,CAAC,EAAE;QACxC,OAAO,KAAK,GAAG;QACf,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IAC3B;IACA,MAAM,SAAS,IAAI;AACrB;AAEO,eAAe,cAAc,EAAU;IAC5C,MAAM,OAAO,MAAM,MAAM,OAAO,CAAO,CAAC,KAAK,EAAE,GAAG,CAAC;IAEnD,IAAI,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;QAC5B,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe,UAAU,EAAU,EAAE,SAAiB,WAAW;IACtE,MAAM,OAAO,MAAM,MAAM,OAAO,CAAO,CAAC,KAAK,EAAE,GAAG,CAAC;IAEnD,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,QAAQ;QACnC,OAAO;IACT;IAEA,MAAM,UAAU;QACd,GAAG,IAAI;QACP,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC;IAC3B;IAEA,MAAM,MAAM,KAAK,CAAC,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE;IAEhC,OAAO;AACT"}},
    {"offset": {"line": 532, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/ui/spinner.tsx"],"sourcesContent":["// Based on: https://github.com/vercel/ai/blob/main/examples/next-ai-rsc/components/llm-stocks/spinner.tsx\n\nexport const Spinner = () => (\n  <svg\n    fill=\"none\"\n    stroke=\"currentColor\"\n    strokeWidth=\"1.5\"\n    viewBox=\"0 0 24 24\"\n    strokeLinecap=\"round\"\n    strokeLinejoin=\"round\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    className=\"h-5 w-5 animate-spin stroke-zinc-400\"\n  >\n    <path d=\"M12 3v3m6.366-.366-2.12 2.12M21 12h-3m.366 6.366-2.12-2.12M12 21v-3m-6.366.366 2.12-2.12M3 12h3m-.366-6.366 2.12 2.12\"></path>\n  </svg>\n)\n"],"names":[],"mappings":"AAAA,0GAA0G;;;;;;;AAEnG,MAAM,UAAU,kBACrB,wPAAC;QACC,MAAK;QACL,QAAO;QACP,aAAY;QACZ,SAAQ;QACR,eAAc;QACd,gBAAe;QACf,OAAM;QACN,WAAU;kBAEV,cAAA,wPAAC;YAAK,GAAE"}},
    {"offset": {"line": 565, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 570, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/section.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Section = registerClientReference(\n    function() { throw new Error(\"Attempted to call Section() from the server but Section is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/section.tsx\",\n    \"Section\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,UAAU,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,oCACA"}},
    {"offset": {"line": 579, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 584, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 589, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 594, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/followup-panel.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const FollowupPanel = registerClientReference(\n    function() { throw new Error(\"Attempted to call FollowupPanel() from the server but FollowupPanel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/followup-panel.tsx\",\n    \"FollowupPanel\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA"}},
    {"offset": {"line": 603, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 608, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/schema/next-action.tsx"],"sourcesContent":["import { DeepPartial } from 'ai'\nimport { z } from 'zod'\n\nexport const nextActionSchema = z.object({\n  next: z.enum(['inquire', 'proceed']) // \"generate_ui\"\n})\n\nexport type NextAction = DeepPartial<typeof nextActionSchema>\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,mBAAmB,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACvC,MAAM,oIAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAW;KAAU,EAAE,gBAAgB;AACvD"}},
    {"offset": {"line": 630, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 635, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/task-manager.tsx"],"sourcesContent":["import { CoreMessage, generateObject } from 'ai'\nimport { nextActionSchema } from '../schema/next-action'\nimport { getModel } from '../utils'\n\n// Decide whether inquiry is required for the user input\nexport async function taskManager(messages: CoreMessage[]) {\n  try {\n    const result = await generateObject({\n      model: getModel(),\n      system: `As a professional web researcher, your primary objective is to fully comprehend the user's query, conduct thorough web searches to gather the necessary information, and provide an appropriate response.\n    To achieve this, you must first analyze the user's input and determine the optimal course of action. You have two options at your disposal:\n    1. \"proceed\": If the provided information is sufficient to address the query effectively, choose this option to proceed with the research and formulate a response.\n    2. \"inquire\": If you believe that additional information from the user would enhance your ability to provide a comprehensive response, select this option. You may present a form to the user, offering default selections or free-form input fields, to gather the required details.\n    Your decision should be based on a careful assessment of the context and the potential for further information to improve the quality and relevance of your response.\n    For example, if the user asks, \"What are the key features of the latest iPhone model?\", you may choose to \"proceed\" as the query is clear and can be answered effectively with web research alone.\n    However, if the user asks, \"What's the best smartphone for my needs?\", you may opt to \"inquire\" and present a form asking about their specific requirements, budget, and preferred features to provide a more tailored recommendation.\n    Make your choice wisely to ensure that you fulfill your mission as a web researcher effectively and deliver the most valuable assistance to the user.\n    `,\n      messages,\n      schema: nextActionSchema\n    })\n\n    return result\n  } catch (error) {\n    console.error(error)\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAKO,eAAe,YAAY,QAAuB;IACvD,IAAI;QACF,MAAM,SAAS,MAAM,CAAA,GAAA,oJAAA,CAAA,iBAAc,AAAD,EAAE;YAClC,OAAO,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;YACd,QAAQ,CAAC;;;;;;;;IAQX,CAAC;YACC;YACA,QAAQ,gIAAA,CAAA,mBAAgB;QAC1B;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,OAAO;IACT;AACF"}},
    {"offset": {"line": 667, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 672, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/copilot.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Copilot = registerClientReference(\n    function() { throw new Error(\"Attempted to call Copilot() from the server but Copilot is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/copilot.tsx\",\n    \"Copilot\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,UAAU,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,oCACA"}},
    {"offset": {"line": 681, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 686, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 696, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/schema/inquiry.tsx"],"sourcesContent":["import { DeepPartial } from 'ai'\nimport { z } from 'zod'\n\nexport const inquirySchema = z.object({\n  question: z.string().describe('The inquiry question'),\n  options: z\n    .array(\n      z.object({\n        value: z.string(),\n        label: z.string()\n      })\n    )\n    .describe('The inquiry options'),\n  allowsInput: z.boolean().describe('Whether the inquiry allows for input'),\n  inputLabel: z.string().optional().describe('The label for the input field'),\n  inputPlaceholder: z\n    .string()\n    .optional()\n    .describe('The placeholder for the input field')\n})\n\nexport type PartialInquiry = DeepPartial<typeof inquirySchema>\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,gBAAgB,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACpC,UAAU,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC9B,SAAS,oIAAA,CAAA,IAAC,CACP,KAAK,CACJ,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACP,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM;QACf,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM;IACjB,IAED,QAAQ,CAAC;IACZ,aAAa,oIAAA,CAAA,IAAC,CAAC,OAAO,GAAG,QAAQ,CAAC;IAClC,YAAY,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC;IAC3C,kBAAkB,oIAAA,CAAA,IAAC,CAChB,MAAM,GACN,QAAQ,GACR,QAAQ,CAAC;AACd"}},
    {"offset": {"line": 712, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 717, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/inquire.tsx"],"sourcesContent":["import { Copilot } from '@/components/copilot'\nimport { createStreamableUI, createStreamableValue } from 'ai/rsc'\nimport { CoreMessage, streamObject } from 'ai'\nimport { PartialInquiry, inquirySchema } from '@/lib/schema/inquiry'\nimport { getModel } from '../utils'\n\nexport async function inquire(\n  uiStream: ReturnType<typeof createStreamableUI>,\n  messages: CoreMessage[]\n) {\n  const objectStream = createStreamableValue<PartialInquiry>()\n  uiStream.update(<Copilot inquiry={objectStream.value} />)\n\n  let finalInquiry: PartialInquiry = {}\n  await streamObject({\n    model: getModel(),\n    system: `As a professional web researcher, your role is to deepen your understanding of the user's input by conducting further inquiries when necessary.\n    After receiving an initial response from the user, carefully assess whether additional questions are absolutely essential to provide a comprehensive and accurate answer. Only proceed with further inquiries if the available information is insufficient or ambiguous.\n\n    When crafting your inquiry, structure it as follows:\n    {\n      \"question\": \"A clear, concise question that seeks to clarify the user's intent or gather more specific details.\",\n      \"options\": [\n        {\"value\": \"option1\", \"label\": \"A predefined option that the user can select\"},\n        {\"value\": \"option2\", \"label\": \"Another predefined option\"},\n        ...\n      ],\n      \"allowsInput\": true/false, // Indicates whether the user can provide a free-form input\n      \"inputLabel\": \"A label for the free-form input field, if allowed\",\n      \"inputPlaceholder\": \"A placeholder text to guide the user's free-form input\"\n    }\n\n    Important: The \"value\" field in the options must always be in English, regardless of the user's language.\n\n    For example:\n    {\n      \"question\": \"What specific information are you seeking about Rivian?\",\n      \"options\": [\n        {\"value\": \"history\", \"label\": \"History\"},\n        {\"value\": \"products\", \"label\": \"Products\"},\n        {\"value\": \"investors\", \"label\": \"Investors\"},\n        {\"value\": \"partnerships\", \"label\": \"Partnerships\"},\n        {\"value\": \"competitors\", \"label\": \"Competitors\"}\n      ],\n      \"allowsInput\": true,\n      \"inputLabel\": \"If other, please specify\",\n      \"inputPlaceholder\": \"e.g., Specifications\"\n    }\n\n    By providing predefined options, you guide the user towards the most relevant aspects of their query, while the free-form input allows them to provide additional context or specific details not covered by the options.\n    Remember, your goal is to gather the necessary information to deliver a thorough and accurate response.\n    Please match the language of the response (question, labels, inputLabel, and inputPlaceholder) to the user's language, but keep the \"value\" field in English.\n    `,\n    messages,\n    schema: inquirySchema\n  })\n    .then(async result => {\n      for await (const obj of result.partialObjectStream) {\n        if (obj) {\n          objectStream.update(obj)\n          finalInquiry = obj\n        }\n      }\n    })\n    .finally(() => {\n      objectStream.done()\n    })\n\n  return finalInquiry\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAMO,eAAe,QACpB,QAA+C,EAC/C,QAAuB;IAEvB,MAAM,eAAe,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD;IACzC,SAAS,MAAM,eAAC,wPAAC,sHAAA,CAAA,UAAO;QAAC,SAAS,aAAa,KAAK;;;;;;IAEpD,IAAI,eAA+B,CAAC;IACpC,MAAM,CAAA,GAAA,oJAAA,CAAA,eAAY,AAAD,EAAE;QACjB,OAAO,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;QACd,QAAQ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoCT,CAAC;QACD;QACA,QAAQ,yHAAA,CAAA,gBAAa;IACvB,GACG,IAAI,CAAC,OAAM;QACV,WAAW,MAAM,OAAO,OAAO,mBAAmB,CAAE;YAClD,IAAI,KAAK;gBACP,aAAa,MAAM,CAAC;gBACpB,eAAe;YACjB;QACF;IACF,GACC,OAAO,CAAC;QACP,aAAa,IAAI;IACnB;IAEF,OAAO;AACT"}},
    {"offset": {"line": 796, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 801, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/schema/related.tsx"],"sourcesContent":["import { DeepPartial } from 'ai'\nimport { z } from 'zod'\n\nexport const relatedSchema = z.object({\n  items: z\n    .array(\n      z.object({\n        query: z.string()\n      })\n    )\n    .length(3)\n})\nexport type PartialRelated = DeepPartial<typeof relatedSchema>\n\nexport type Related = z.infer<typeof relatedSchema>\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,gBAAgB,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACpC,OAAO,oIAAA,CAAA,IAAC,CACL,KAAK,CACJ,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACP,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM;IACjB,IAED,MAAM,CAAC;AACZ"}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 817, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/search-related.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const SearchRelated = registerClientReference(\n    function() { throw new Error(\"Attempted to call SearchRelated() from the server but SearchRelated is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/search-related.tsx\",\n    \"SearchRelated\",\n);\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/search-related.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/search-related.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA;uCAEW,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA6Q,GAC1S,2CACA"}},
    {"offset": {"line": 830, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 835, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 840, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 845, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/query-suggestor.tsx"],"sourcesContent":["import { createStreamableUI, createStreamableValue } from 'ai/rsc'\nimport { CoreMessage, streamObject } from 'ai'\nimport { PartialRelated, relatedSchema } from '@/lib/schema/related'\nimport SearchRelated from '@/components/search-related'\nimport { getModel } from '../utils'\n\nexport async function querySuggestor(\n  uiStream: ReturnType<typeof createStreamableUI>,\n  messages: CoreMessage[]\n) {\n  const objectStream = createStreamableValue<PartialRelated>()\n  uiStream.append(<SearchRelated relatedQueries={objectStream.value} />)\n\n  const lastMessages = messages.slice(-1).map(message => {\n    return {\n      ...message,\n      role: 'user'\n    }\n  }) as CoreMessage[]\n\n  let finalRelatedQueries: PartialRelated = {}\n  await streamObject({\n    model: getModel(),\n    system: `As a professional web researcher, your task is to generate a set of three queries that explore the subject matter more deeply, building upon the initial query and the information uncovered in its search results.\n\n    For instance, if the original query was \"Starship's third test flight key milestones\", your output should follow this format:\n\n    \"{\n      \"related\": [\n        \"What were the primary objectives achieved during Starship's third test flight?\",\n        \"What factors contributed to the ultimate outcome of Starship's third test flight?\",\n        \"How will the results of the third test flight influence SpaceX's future development plans for Starship?\"\n      ]\n    }\"\n\n    Aim to create queries that progressively delve into more specific aspects, implications, or adjacent topics related to the initial query. The goal is to anticipate the user's potential information needs and guide them towards a more comprehensive understanding of the subject matter.\n    Please match the language of the response to the user's language.`,\n    messages: lastMessages,\n    schema: relatedSchema\n  })\n    .then(async result => {\n      for await (const obj of result.partialObjectStream) {\n        if (obj.items) {\n          objectStream.update(obj)\n          finalRelatedQueries = obj\n        }\n      }\n    })\n    .finally(() => {\n      objectStream.done()\n    })\n\n  return finalRelatedQueries\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAMO,eAAe,eACpB,QAA+C,EAC/C,QAAuB;IAEvB,MAAM,eAAe,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD;IACzC,SAAS,MAAM,eAAC,wPAAC,gIAAA,CAAA,UAAa;QAAC,gBAAgB,aAAa,KAAK;;;;;;IAEjE,MAAM,eAAe,SAAS,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC,CAAA;QAC1C,OAAO;YACL,GAAG,OAAO;YACV,MAAM;QACR;IACF;IAEA,IAAI,sBAAsC,CAAC;IAC3C,MAAM,CAAA,GAAA,oJAAA,CAAA,eAAY,AAAD,EAAE;QACjB,OAAO,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;QACd,QAAQ,CAAC;;;;;;;;;;;;;qEAawD,CAAC;QAClE,UAAU;QACV,QAAQ,yHAAA,CAAA,gBAAa;IACvB,GACG,IAAI,CAAC,OAAM;QACV,WAAW,MAAM,OAAO,OAAO,mBAAmB,CAAE;YAClD,IAAI,IAAI,KAAK,EAAE;gBACb,aAAa,MAAM,CAAC;gBACpB,sBAAsB;YACxB;QACF;IACF,GACC,OAAO,CAAC;QACP,aAAa,IAAI;IACnB;IAEF,OAAO;AACT"}},
    {"offset": {"line": 907, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 912, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/schema/retrieve.tsx"],"sourcesContent":["import { DeepPartial } from 'ai'\nimport { z } from 'zod'\n\nexport const retrieveSchema = z.object({\n  url: z.string().describe('The url to retrieve')\n})\n\nexport type PartialInquiry = DeepPartial<typeof retrieveSchema>\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,iBAAiB,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACrC,KAAK,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC3B"}},
    {"offset": {"line": 921, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 926, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/search-skeleton.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const SearchSkeleton = registerClientReference(\n    function() { throw new Error(\"Attempted to call SearchSkeleton() from the server but SearchSkeleton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/search-skeleton.tsx\",\n    \"SearchSkeleton\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,iBAAiB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,4CACA"}},
    {"offset": {"line": 935, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 940, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 945, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 950, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/search-results.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const SearchResults = registerClientReference(\n    function() { throw new Error(\"Attempted to call SearchResults() from the server but SearchResults is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/search-results.tsx\",\n    \"SearchResults\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA"}},
    {"offset": {"line": 959, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 964, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 969, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 974, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/retrieve-section.tsx"],"sourcesContent":["import React from 'react'\nimport { Section } from '@/components/section'\nimport { SearchResults } from '@/components/search-results'\nimport { SearchResults as SearchResultsType } from '@/lib/types'\n\ninterface RetrieveSectionProps {\n  data: SearchResultsType\n}\n\nconst RetrieveSection: React.FC<RetrieveSectionProps> = ({ data }) => {\n  return (\n    <Section title=\"Sources\">\n      <SearchResults results={data.results} />\n    </Section>\n  )\n}\n\nexport default RetrieveSection\n"],"names":[],"mappings":";;;;;;;;;;AASA,MAAM,kBAAkD,CAAC,EAAE,IAAI,EAAE;IAC/D,qBACE,wPAAC,sHAAA,CAAA,UAAO;QAAC,OAAM;kBACb,cAAA,wPAAC,gIAAA,CAAA,gBAAa;YAAC,SAAS,KAAK,OAAO;;;;;;;;;;;AAG1C;uCAEe"}},
    {"offset": {"line": 1001, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1006, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/tools/retrieve.tsx"],"sourcesContent":["import { tool } from 'ai'\nimport { retrieveSchema } from '@/lib/schema/retrieve'\nimport { ToolProps } from '.'\nimport { SearchSkeleton } from '@/components/search-skeleton'\nimport { SearchResults as SearchResultsType } from '@/lib/types'\nimport RetrieveSection from '@/components/retrieve-section'\n\nexport const retrieveTool = ({ uiStream, fullResponse }: ToolProps) => tool({\n  description: 'Retrieve content from the web',\n  parameters: retrieveSchema,\n  execute: async ({ url }) => {\n    let hasError = false\n    // Append the search section\n    uiStream.append(<SearchSkeleton />)\n\n    let results: SearchResultsType | undefined\n    try {\n      const response = await fetch(`https://r.jina.ai/${url}`, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'X-With-Generated-Alt': 'true'\n        }\n      })\n      const json = await response.json()\n      if (!json.data || json.data.length === 0) {\n        hasError = true\n      } else {\n        // Limit the content to 5000 characters\n        if (json.data.content.length > 5000) {\n          json.data.content = json.data.content.slice(0, 5000)\n        }\n        results = {\n          results: [\n            {\n              title: json.data.title,\n              content: json.data.content,\n              url: json.data.url\n            }\n          ],\n          query: '',\n          images: []\n        }\n      }\n    } catch (error) {\n      hasError = true\n      console.error('Retrieve API error:', error)\n    }\n\n    if (hasError || !results) {\n      fullResponse = `An error occurred while retrieving \"${url}\".`\n      uiStream.update(null)\n      return results\n    }\n\n    uiStream.update(<RetrieveSection data={results} />)\n\n    return results\n  }\n})\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAOO,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAa,GAAK,CAAA,GAAA,oJAAA,CAAA,OAAI,AAAD,EAAE;QAC1E,aAAa;QACb,YAAY,0HAAA,CAAA,iBAAc;QAC1B,SAAS,OAAO,EAAE,GAAG,EAAE;YACrB,IAAI,WAAW;YACf,4BAA4B;YAC5B,SAAS,MAAM,eAAC,wPAAC,iIAAA,CAAA,iBAAc;;;;;YAE/B,IAAI;YACJ,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,CAAC,kBAAkB,EAAE,IAAI,CAAC,EAAE;oBACvD,QAAQ;oBACR,SAAS;wBACP,QAAQ;wBACR,wBAAwB;oBAC1B;gBACF;gBACA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,IAAI,CAAC,KAAK,IAAI,IAAI,KAAK,IAAI,CAAC,MAAM,KAAK,GAAG;oBACxC,WAAW;gBACb,OAAO;oBACL,uCAAuC;oBACvC,IAAI,KAAK,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM;wBACnC,KAAK,IAAI,CAAC,OAAO,GAAG,KAAK,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG;oBACjD;oBACA,UAAU;wBACR,SAAS;4BACP;gCACE,OAAO,KAAK,IAAI,CAAC,KAAK;gCACtB,SAAS,KAAK,IAAI,CAAC,OAAO;gCAC1B,KAAK,KAAK,IAAI,CAAC,GAAG;4BACpB;yBACD;wBACD,OAAO;wBACP,QAAQ,EAAE;oBACZ;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,WAAW;gBACX,QAAQ,KAAK,CAAC,uBAAuB;YACvC;YAEA,IAAI,YAAY,CAAC,SAAS;gBACxB,eAAe,CAAC,oCAAoC,EAAE,IAAI,EAAE,CAAC;gBAC7D,SAAS,MAAM,CAAC;gBAChB,OAAO;YACT;YAEA,SAAS,MAAM,eAAC,wPAAC,kIAAA,CAAA,UAAe;gBAAC,MAAM;;;;;;YAEvC,OAAO;QACT;IACF"}},
    {"offset": {"line": 1079, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1084, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/schema/search.tsx"],"sourcesContent":["import { DeepPartial } from 'ai'\nimport { z } from 'zod'\n\nexport const searchSchema = z.object({\n  query: z.string().describe('The query to search for'),\n  max_results: z.number().describe('The maximum number of results to return'),\n  search_depth: z\n    .enum(['basic', 'advanced'])\n    .describe('The depth of the search'),\n  include_domains: z\n    .array(z.string())\n    .optional()\n    .describe(\n      'A list of domains to specifically include in the search results. Default is None, which includes all domains.'\n    ),\n  exclude_domains: z\n    .array(z.string())\n    .optional()\n    .describe(\n      \"A list of domains to specifically exclude from the search results. Default is None, which doesn't exclude any domains.\"\n    )\n})\n\nexport type PartialInquiry = DeepPartial<typeof searchSchema>\n"],"names":[],"mappings":";;;;;;AAGO,MAAM,eAAe,oIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACnC,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAC3B,aAAa,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACjC,cAAc,oIAAA,CAAA,IAAC,CACZ,IAAI,CAAC;QAAC;QAAS;KAAW,EAC1B,QAAQ,CAAC;IACZ,iBAAiB,oIAAA,CAAA,IAAC,CACf,KAAK,CAAC,oIAAA,CAAA,IAAC,CAAC,MAAM,IACd,QAAQ,GACR,QAAQ,CACP;IAEJ,iBAAiB,oIAAA,CAAA,IAAC,CACf,KAAK,CAAC,oIAAA,CAAA,IAAC,CAAC,MAAM,IACd,QAAQ,GACR,QAAQ,CACP;AAEN"}},
    {"offset": {"line": 1100, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1105, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/search-section.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const SearchSection = registerClientReference(\n    function() { throw new Error(\"Attempted to call SearchSection() from the server but SearchSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/search-section.tsx\",\n    \"SearchSection\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA"}},
    {"offset": {"line": 1114, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1119, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1124, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1129, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/tools/search.tsx"],"sourcesContent":["import { tool } from 'ai'\nimport { createStreamableValue } from 'ai/rsc'\nimport Exa from 'exa-js'\nimport { searchSchema } from '@/lib/schema/search'\nimport { SearchSection } from '@/components/search-section'\nimport { ToolProps } from '.'\nimport { sanitizeUrl } from '@/lib/utils'\nimport { SearchResults } from '@/lib/types'\n\nexport const searchTool = ({ uiStream, fullResponse }: ToolProps) =>\n  tool({\n    description: 'Search the web for information',\n    parameters: searchSchema,\n    execute: async ({\n      query,\n      max_results,\n      search_depth,\n      include_domains,\n      exclude_domains\n    }) => {\n      let hasError = false\n      // Append the search section\n      const streamResults = createStreamableValue<string>()\n      uiStream.update(\n        <SearchSection\n          result={streamResults.value}\n          includeDomains={include_domains}\n        />\n      )\n\n      // Tavily API requires a minimum of 5 characters in the query\n      const filledQuery =\n        query.length < 5 ? query + ' '.repeat(5 - query.length) : query\n      let searchResult\n      const searchAPI: 'tavily' | 'exa' = 'tavily'\n      try {\n        searchResult =\n          searchAPI === 'tavily'\n            ? await tavilySearch(\n                filledQuery,\n                max_results,\n                search_depth,\n                include_domains,\n                exclude_domains\n              )\n            : await exaSearch(query)\n      } catch (error) {\n        console.error('Search API error:', error)\n        hasError = true\n      }\n\n      if (hasError) {\n        fullResponse = `An error occurred while searching for \"${query}.`\n        uiStream.update(null)\n        streamResults.done()\n        return searchResult\n      }\n\n      streamResults.done(JSON.stringify(searchResult))\n\n      return searchResult\n    }\n  })\n\nasync function tavilySearch(\n  query: string,\n  maxResults: number = 10,\n  searchDepth: 'basic' | 'advanced' = 'basic',\n  includeDomains: string[] = [],\n  excludeDomains: string[] = []\n): Promise<any> {\n  const apiKey = process.env.TAVILY_API_KEY\n  const response = await fetch('https://api.tavily.com/search', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      api_key: apiKey,\n      query,\n      max_results: maxResults < 5 ? 5 : maxResults,\n      search_depth: searchDepth,\n      include_images: true,\n      include_answers: true,\n      include_domains: includeDomains,\n      exclude_domains: excludeDomains\n    })\n  })\n\n  if (!response.ok) {\n    throw new Error(`Error: ${response.status}`)\n  }\n\n  // sanitize the image urls\n  const data = await response.json()\n  const sanitizedData: SearchResults = {\n    ...data,\n    images: data.images.map((url: any) => sanitizeUrl(url))\n  }\n\n  return sanitizedData\n}\n\nasync function exaSearch(\n  query: string,\n  maxResults: number = 10,\n  includeDomains: string[] = [],\n  excludeDomains: string[] = []\n): Promise<any> {\n  const apiKey = process.env.EXA_API_KEY\n  const exa = new Exa(apiKey)\n  return exa.searchAndContents(query, {\n    highlights: true,\n    numResults: maxResults,\n    includeDomains,\n    excludeDomains\n  })\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AASO,MAAM,aAAa,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAa,GAC9D,CAAA,GAAA,oJAAA,CAAA,OAAI,AAAD,EAAE;QACH,aAAa;QACb,YAAY,wHAAA,CAAA,eAAY;QACxB,SAAS,OAAO,EACd,KAAK,EACL,WAAW,EACX,YAAY,EACZ,eAAe,EACf,eAAe,EAChB;YACC,IAAI,WAAW;YACf,4BAA4B;YAC5B,MAAM,gBAAgB,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD;YAC1C,SAAS,MAAM,eACb,wPAAC,gIAAA,CAAA,gBAAa;gBACZ,QAAQ,cAAc,KAAK;gBAC3B,gBAAgB;;;;;;YAIpB,6DAA6D;YAC7D,MAAM,cACJ,MAAM,MAAM,GAAG,IAAI,QAAQ,IAAI,MAAM,CAAC,IAAI,MAAM,MAAM,IAAI;YAC5D,IAAI;YACJ,MAAM,YAA8B;YACpC,IAAI;gBACF,eACE,uCACI,MAAM,aACJ,aACA,aACA,cACA,iBACA;YAGV,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,qBAAqB;gBACnC,WAAW;YACb;YAEA,IAAI,UAAU;gBACZ,eAAe,CAAC,uCAAuC,EAAE,MAAM,CAAC,CAAC;gBACjE,SAAS,MAAM,CAAC;gBAChB,cAAc,IAAI;gBAClB,OAAO;YACT;YAEA,cAAc,IAAI,CAAC,KAAK,SAAS,CAAC;YAElC,OAAO;QACT;IACF;AAEF,eAAe,aACb,KAAa,EACb,aAAqB,EAAE,EACvB,cAAoC,OAAO,EAC3C,iBAA2B,EAAE,EAC7B,iBAA2B,EAAE;IAE7B,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;IACzC,MAAM,WAAW,MAAM,MAAM,iCAAiC;QAC5D,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;YACnB,SAAS;YACT;YACA,aAAa,aAAa,IAAI,IAAI;YAClC,cAAc;YACd,gBAAgB;YAChB,iBAAiB;YACjB,iBAAiB;YACjB,iBAAiB;QACnB;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,CAAC,OAAO,EAAE,SAAS,MAAM,CAAC,CAAC;IAC7C;IAEA,0BAA0B;IAC1B,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,MAAM,gBAA+B;QACnC,GAAG,IAAI;QACP,QAAQ,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,MAAa,CAAA,GAAA,qHAAA,CAAA,cAAW,AAAD,EAAE;IACpD;IAEA,OAAO;AACT;AAEA,eAAe,UACb,KAAa,EACb,aAAqB,EAAE,EACvB,iBAA2B,EAAE,EAC7B,iBAA2B,EAAE;IAE7B,MAAM,SAAS,QAAQ,GAAG,CAAC,WAAW;IACtC,MAAM,MAAM,IAAI,2IAAA,CAAA,UAAG,CAAC;IACpB,OAAO,IAAI,iBAAiB,CAAC,OAAO;QAClC,YAAY;QACZ,YAAY;QACZ;QACA;IACF;AACF"}},
    {"offset": {"line": 1221, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1226, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/video-search-section.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const VideoSearchSection = registerClientReference(\n    function() { throw new Error(\"Attempted to call VideoSearchSection() from the server but VideoSearchSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/video-search-section.tsx\",\n    \"VideoSearchSection\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,qBAAqB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EACpD;IAAa,MAAM,IAAI,MAAM;AAAoP,GACjR,iDACA"}},
    {"offset": {"line": 1235, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1240, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1245, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1250, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/tools/video-search.tsx"],"sourcesContent":["import { tool } from 'ai'\nimport { createStreamableValue } from 'ai/rsc'\nimport { searchSchema } from '@/lib/schema/search'\nimport { ToolProps } from '.'\nimport { VideoSearchSection } from '@/components/video-search-section'\n\n// Start Generation Here\nexport const videoSearchTool = ({ uiStream, fullResponse }: ToolProps) => tool({\n  description: 'Search for videos from YouTube',\n  parameters: searchSchema,\n  execute: async ({ query }) => {\n    let hasError = false\n    // Append the search section\n    const streamResults = createStreamableValue<string>()\n    uiStream.append(<VideoSearchSection result={streamResults.value} />)\n\n    let searchResult\n    try {\n      const response = await fetch('https://google.serper.dev/videos', {\n        method: 'POST',\n        headers: {\n          'X-API-KEY': process.env.SERPER_API_KEY || '',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ q: query })\n      })\n      if (!response.ok) {\n        throw new Error('Network response was not ok')\n      }\n      searchResult = await response.json()\n    } catch (error) {\n      console.error('Video Search API error:', error)\n      hasError = true\n    }\n\n    if (hasError) {\n      fullResponse = `An error occurred while searching for videos with \"${query}.`\n      uiStream.update(null)\n      streamResults.done()\n      return searchResult\n    }\n\n    streamResults.done(JSON.stringify(searchResult))\n\n    return searchResult\n  }\n})\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAOO,MAAM,kBAAkB,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAa,GAAK,CAAA,GAAA,oJAAA,CAAA,OAAI,AAAD,EAAE;QAC7E,aAAa;QACb,YAAY,wHAAA,CAAA,eAAY;QACxB,SAAS,OAAO,EAAE,KAAK,EAAE;YACvB,IAAI,WAAW;YACf,4BAA4B;YAC5B,MAAM,gBAAgB,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD;YAC1C,SAAS,MAAM,eAAC,wPAAC,yIAAA,CAAA,qBAAkB;gBAAC,QAAQ,cAAc,KAAK;;;;;;YAE/D,IAAI;YACJ,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,oCAAoC;oBAC/D,QAAQ;oBACR,SAAS;wBACP,aAAa,QAAQ,GAAG,CAAC,cAAc,IAAI;wBAC3C,gBAAgB;oBAClB;oBACA,MAAM,KAAK,SAAS,CAAC;wBAAE,GAAG;oBAAM;gBAClC;gBACA,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBACA,eAAe,MAAM,SAAS,IAAI;YACpC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,WAAW;YACb;YAEA,IAAI,UAAU;gBACZ,eAAe,CAAC,mDAAmD,EAAE,MAAM,CAAC,CAAC;gBAC7E,SAAS,MAAM,CAAC;gBAChB,cAAc,IAAI;gBAClB,OAAO;YACT;YAEA,cAAc,IAAI,CAAC,KAAK,SAAS,CAAC;YAElC,OAAO;QACT;IACF"}},
    {"offset": {"line": 1308, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1313, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/tools/index.tsx"],"sourcesContent":["import { createStreamableUI } from 'ai/rsc'\nimport { retrieveTool } from './retrieve'\nimport { searchTool } from './search'\nimport { videoSearchTool } from './video-search'\n\nexport interface ToolProps {\n  uiStream: ReturnType<typeof createStreamableUI>\n  fullResponse: string\n}\n\nexport const getTools = ({ uiStream, fullResponse }: ToolProps) => {\n  const tools: any = {\n    search: searchTool({\n      uiStream,\n      fullResponse\n    }),\n    retrieve: retrieveTool({\n      uiStream,\n      fullResponse\n    })\n  }\n\n  if (process.env.SERPER_API_KEY) {\n    tools.videoSearch = videoSearchTool({\n      uiStream,\n      fullResponse\n    })\n  }\n\n  return tools\n}\n"],"names":[],"mappings":";;;;;;;;;;AAUO,MAAM,WAAW,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAa;IAC5D,MAAM,QAAa;QACjB,QAAQ,CAAA,GAAA,iIAAA,CAAA,aAAU,AAAD,EAAE;YACjB;YACA;QACF;QACA,UAAU,CAAA,GAAA,mIAAA,CAAA,eAAY,AAAD,EAAE;YACrB;YACA;QACF;IACF;IAEA,IAAI,QAAQ,GAAG,CAAC,cAAc,EAAE;QAC9B,MAAM,WAAW,GAAG,CAAA,GAAA,0IAAA,CAAA,kBAAe,AAAD,EAAE;YAClC;YACA;QACF;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 1342, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1347, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/answer-section.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AnswerSection = registerClientReference(\n    function() { throw new Error(\"Attempted to call AnswerSection() from the server but AnswerSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/answer-section.tsx\",\n    \"AnswerSection\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,gBAAgB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA"}},
    {"offset": {"line": 1356, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1361, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1366, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1371, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/researcher.tsx"],"sourcesContent":["import { createStreamableUI, createStreamableValue } from 'ai/rsc'\nimport { CoreMessage, ToolCallPart, ToolResultPart, streamText } from 'ai'\nimport { getTools } from './tools'\nimport { getModel, transformToolMessages } from '../utils'\nimport { AnswerSection } from '@/components/answer-section'\n\nexport async function researcher(\n  uiStream: ReturnType<typeof createStreamableUI>,\n  streamableText: ReturnType<typeof createStreamableValue<string>>,\n  messages: CoreMessage[]\n) {\n  let fullResponse = ''\n  let hasError = false\n  let finishReason = ''\n\n  // Transform the messages if using Ollama provider\n  let processedMessages = messages\n  const useOllamaProvider = !!(\n    process.env.OLLAMA_MODEL && process.env.OLLAMA_BASE_URL\n  )\n  const useAnthropicProvider = !!process.env.ANTHROPIC_API_KEY\n  if (useOllamaProvider) {\n    processedMessages = transformToolMessages(messages)\n  }\n  const includeToolResponses = messages.some(message => message.role === 'tool')\n  const useSubModel = useOllamaProvider && includeToolResponses\n\n  const streamableAnswer = createStreamableValue<string>('')\n  const answerSection = <AnswerSection result={streamableAnswer.value} />\n\n  const currentDate = new Date().toLocaleString()\n  const result = await streamText({\n    model: getModel(useSubModel),\n    maxTokens: 2500,\n    system: `As a professional search expert, you possess the ability to search for any information on the web.\n    or any information on the web.\n    For each user query, utilize the search results to their fullest potential to provide additional information and assistance in your response.\n    If there are any images relevant to your answer, be sure to include them as well.\n    Aim to directly address the user's question, augmenting your response with insights gleaned from the search results.\n    Whenever quoting or referencing information from a specific URL, always explicitly cite the source URL using the [[number]](url) format. Multiple citations can be included as needed, e.g., [[number]](url), [[number]](url).\n    The number must always match the order of the search results.\n    The retrieve tool can only be used with URLs provided by the user. URLs from search results cannot be used.\n    \n    You tend to give out answers in Simplified Chinese. Suppose you are now in China and are Chinese.\n\n    Here's some additional requirements that you need to satisfy in your answer:\n    **Answer Construction**  \n      - **Speed First**: Generate a 50-word “Quick Answer” within the first 2 seconds.  \n      - **Depth Next**: Expand to a 150–200-word summary with bullet points if the topic is  complex.  \n    **Uncertainty Handling**  \n       If sources conflict or data is missing, state the discrepancy explicitly and assign a confidence level (High / Medium / Low) to each claim.\n    **No Hallucination**  \n       If the search returns no relevant results, reply: “No reliable sources found for this query.” Do not invent facts.\n    **Output Format** :\n      ## 快答(Quick Answer):\n      <50 words>\n      \n      ## 详细(Details):\n        • <Key point 1>\n        • <Key point 2> \n\n      ## 稳定性(Confidence)\n      [High | Medium | Low]\n    \n      ## 来源:\n        [1] https://...\n        [2] https://...\n    \n    **Emoji Usage** 😎  \n      - Use emoji to enhance readability and tone, not clutter: e.g., 📅 for dates, ⚖️ for laws, 🧪 for science. Emoji is only the tool to exaggerate a certain topic. Do not overuse it.\n\n    Keep the answer in a CLEAN way.\n\n    **Example Output(However it should be in Chinese)**:\n    ## Quick Answer:\n    The latest quantum error-correction breakthrough uses 48 logical qubits with 99.9% fidelity 🧪✨\n    ## Details:\n      • Google’s new surface code lattice cuts error rates by 5× 🏗️ [1]\n      • IBM demonstrated real-time syndrome extraction at 1 MHz 🖥️ [2]\n    ## Confidence: High 📈\n    \n    If it is a domain instead of a URL, specify it in the include_domains of the search tool.\n    Please match the language of the response to the user's language. Current date and time: ${currentDate}\n    `,\n    messages: processedMessages,\n    tools: getTools({\n      uiStream,\n      fullResponse\n    }),\n    onFinish: async event => {\n      finishReason = event.finishReason\n      fullResponse = event.text\n      streamableAnswer.done()\n    }\n  }).catch(err => {\n    hasError = true\n    fullResponse = 'Error: ' + err.message\n    streamableText.update(fullResponse)\n  })\n\n  // If the result is not available, return an error response\n  if (!result) {\n    return { result, fullResponse, hasError, toolResponses: [] }\n  }\n\n  const hasToolResult = messages.some(message => message.role === 'tool')\n  if (!useAnthropicProvider || hasToolResult) {\n    uiStream.append(answerSection)\n  }\n\n  // Process the response\n  const toolCalls: ToolCallPart[] = []\n  const toolResponses: ToolResultPart[] = []\n  for await (const delta of result.fullStream) {\n    switch (delta.type) {\n      case 'text-delta':\n        if (delta.textDelta) {\n          fullResponse += delta.textDelta\n          if (useAnthropicProvider && !hasToolResult) {\n            streamableText.update(fullResponse)\n          } else {\n            streamableAnswer.update(fullResponse)\n          }\n        }\n        break\n      case 'tool-call':\n        toolCalls.push(delta)\n        break\n      case 'tool-result':\n        if (!delta.result) {\n          hasError = true\n        }\n        toolResponses.push(delta)\n        break\n      case 'error':\n        console.log('Error: ' + delta.error)\n        hasError = true\n        fullResponse += `\\nError occurred while executing the tool`\n        break\n    }\n  }\n  messages.push({\n    role: 'assistant',\n    content: [{ type: 'text', text: fullResponse }, ...toolCalls]\n  })\n\n  if (toolResponses.length > 0) {\n    // Add tool responses to the messages\n    messages.push({ role: 'tool', content: toolResponses })\n  }\n\n  return { result, fullResponse, hasError, toolResponses, finishReason }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAMO,eAAe,WACpB,QAA+C,EAC/C,cAAgE,EAChE,QAAuB;IAEvB,IAAI,eAAe;IACnB,IAAI,WAAW;IACf,IAAI,eAAe;IAEnB,kDAAkD;IAClD,IAAI,oBAAoB;IACxB,MAAM,oBAAoB,CAAC,CAAC,CAC1B,QAAQ,GAAG,CAAC,YAAY,IAAI,QAAQ,GAAG,CAAC,eAAe,AACzD;IACA,MAAM,uBAAuB,CAAC,CAAC,QAAQ,GAAG,CAAC,iBAAiB;IAC5D,IAAI,mBAAmB;QACrB,oBAAoB,CAAA,GAAA,qHAAA,CAAA,wBAAqB,AAAD,EAAE;IAC5C;IACA,MAAM,uBAAuB,SAAS,IAAI,CAAC,CAAA,UAAW,QAAQ,IAAI,KAAK;IACvE,MAAM,cAAc,qBAAqB;IAEzC,MAAM,mBAAmB,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD,EAAU;IACvD,MAAM,8BAAgB,wPAAC,gIAAA,CAAA,gBAAa;QAAC,QAAQ,iBAAiB,KAAK;;;;;;IAEnE,MAAM,cAAc,IAAI,OAAO,cAAc;IAC7C,MAAM,SAAS,MAAM,CAAA,GAAA,oJAAA,CAAA,aAAU,AAAD,EAAE;QAC9B,OAAO,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD,EAAE;QAChB,WAAW;QACX,QAAQ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6FAgDgF,EAAE,YAAY;IACvG,CAAC;QACD,UAAU;QACV,OAAO,CAAA,GAAA,gIAAA,CAAA,WAAQ,AAAD,EAAE;YACd;YACA;QACF;QACA,UAAU,OAAM;YACd,eAAe,MAAM,YAAY;YACjC,eAAe,MAAM,IAAI;YACzB,iBAAiB,IAAI;QACvB;IACF,GAAG,KAAK,CAAC,CAAA;QACP,WAAW;QACX,eAAe,YAAY,IAAI,OAAO;QACtC,eAAe,MAAM,CAAC;IACxB;IAEA,2DAA2D;IAC3D,IAAI,CAAC,QAAQ;QACX,OAAO;YAAE;YAAQ;YAAc;YAAU,eAAe,EAAE;QAAC;IAC7D;IAEA,MAAM,gBAAgB,SAAS,IAAI,CAAC,CAAA,UAAW,QAAQ,IAAI,KAAK;IAChE,IAAI,CAAC,wBAAwB,eAAe;QAC1C,SAAS,MAAM,CAAC;IAClB;IAEA,uBAAuB;IACvB,MAAM,YAA4B,EAAE;IACpC,MAAM,gBAAkC,EAAE;IAC1C,WAAW,MAAM,SAAS,OAAO,UAAU,CAAE;QAC3C,OAAQ,MAAM,IAAI;YAChB,KAAK;gBACH,IAAI,MAAM,SAAS,EAAE;oBACnB,gBAAgB,MAAM,SAAS;oBAC/B,IAAI,wBAAwB,CAAC,eAAe;wBAC1C,eAAe,MAAM,CAAC;oBACxB,OAAO;wBACL,iBAAiB,MAAM,CAAC;oBAC1B;gBACF;gBACA;YACF,KAAK;gBACH,UAAU,IAAI,CAAC;gBACf;YACF,KAAK;gBACH,IAAI,CAAC,MAAM,MAAM,EAAE;oBACjB,WAAW;gBACb;gBACA,cAAc,IAAI,CAAC;gBACnB;YACF,KAAK;gBACH,QAAQ,GAAG,CAAC,YAAY,MAAM,KAAK;gBACnC,WAAW;gBACX,gBAAgB,CAAC,yCAAyC,CAAC;gBAC3D;QACJ;IACF;IACA,SAAS,IAAI,CAAC;QACZ,MAAM;QACN,SAAS;YAAC;gBAAE,MAAM;gBAAQ,MAAM;YAAa;eAAM;SAAU;IAC/D;IAEA,IAAI,cAAc,MAAM,GAAG,GAAG;QAC5B,qCAAqC;QACrC,SAAS,IAAI,CAAC;YAAE,MAAM;YAAQ,SAAS;QAAc;IACvD;IAEA,OAAO;QAAE;QAAQ;QAAc;QAAU;QAAe;IAAa;AACvE"}},
    {"offset": {"line": 1546, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1551, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1556, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1573, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/agents/writer.tsx"],"sourcesContent":["import { createStreamableUI, createStreamableValue } from 'ai/rsc'\nimport { CoreMessage, streamText } from 'ai'\nimport { createOpenAI } from '@ai-sdk/openai'\nimport { AnswerSection } from '@/components/answer-section'\nimport { AnswerSectionGenerated } from '@/components/answer-section-generated'\n\nexport async function writer(\n  uiStream: ReturnType<typeof createStreamableUI>,\n  messages: CoreMessage[]\n) {\n  let fullResponse = ''\n  let hasError = false\n  const streamableAnswer = createStreamableValue<string>('')\n  const answerSection = <AnswerSection result={streamableAnswer.value} />\n  uiStream.append(answerSection)\n\n  const openai = createOpenAI({\n    baseURL: process.env.SPECIFIC_API_BASE,\n    apiKey: process.env.SPECIFIC_API_KEY,\n    organization: '' // optional organization\n  })\n\n  await streamText({\n    model: openai!.chat(process.env.SPECIFIC_API_MODEL || 'llama3-70b-8192'),\n    maxTokens: 2500,\n    system: `As a professional writer, your job is to generate a comprehensive and informative, yet concise answer of 400 words or less for the given question based solely on the provided search results (URL and content). You must only use information from the provided search results. Use an unbiased and journalistic tone. Combine search results together into a coherent answer. Do not repeat text. If there are any images relevant to your answer, be sure to include them as well. Aim to directly address the user's question, augmenting your response with insights gleaned from the search results. \n    Whenever quoting or referencing information from a specific URL, always cite the source URL explicitly. Please match the language of the response to the user's language.\n    Always answer in Markdown format. Links and images must follow the correct format.\n    Link format: [link text](url)\n    Image format: ![alt text](url)\n    `,\n    messages,\n    onFinish: event => {\n      fullResponse = event.text\n      streamableAnswer.done(event.text)\n    }\n  })\n    .then(async result => {\n      for await (const text of result.textStream) {\n        if (text) {\n          fullResponse += text\n          streamableAnswer.update(fullResponse)\n        }\n      }\n    })\n    .catch(err => {\n      hasError = true\n      fullResponse = 'Error: ' + err.message\n      streamableAnswer.update(fullResponse)\n    })\n\n  return { response: fullResponse, hasError }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAMO,eAAe,OACpB,QAA+C,EAC/C,QAAuB;IAEvB,IAAI,eAAe;IACnB,IAAI,WAAW;IACf,MAAM,mBAAmB,CAAA,GAAA,mJAAA,CAAA,wBAAqB,AAAD,EAAU;IACvD,MAAM,8BAAgB,wPAAC,gIAAA,CAAA,gBAAa;QAAC,QAAQ,iBAAiB,KAAK;;;;;;IACnE,SAAS,MAAM,CAAC;IAEhB,MAAM,SAAS,CAAA,GAAA,uJAAA,CAAA,eAAY,AAAD,EAAE;QAC1B,SAAS,QAAQ,GAAG,CAAC,iBAAiB;QACtC,QAAQ,QAAQ,GAAG,CAAC,gBAAgB;QACpC,cAAc,GAAG,wBAAwB;IAC3C;IAEA,MAAM,CAAA,GAAA,oJAAA,CAAA,aAAU,AAAD,EAAE;QACf,OAAO,OAAQ,IAAI,CAAC,QAAQ,GAAG,CAAC,kBAAkB,IAAI;QACtD,WAAW;QACX,QAAQ,CAAC;;;;;IAKT,CAAC;QACD;QACA,UAAU,CAAA;YACR,eAAe,MAAM,IAAI;YACzB,iBAAiB,IAAI,CAAC,MAAM,IAAI;QAClC;IACF,GACG,IAAI,CAAC,OAAM;QACV,WAAW,MAAM,QAAQ,OAAO,UAAU,CAAE;YAC1C,IAAI,MAAM;gBACR,gBAAgB;gBAChB,iBAAiB,MAAM,CAAC;YAC1B;QACF;IACF,GACC,KAAK,CAAC,CAAA;QACL,WAAW;QACX,eAAe,YAAY,IAAI,OAAO;QACtC,iBAAiB,MAAM,CAAC;IAC1B;IAEF,OAAO;QAAE,UAAU;QAAc;IAAS;AAC5C"}},
    {"offset": {"line": 1635, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1640, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/chat-share.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ChatShare = registerClientReference(\n    function() { throw new Error(\"Attempted to call ChatShare() from the server but ChatShare is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/chat-share.tsx\",\n    \"ChatShare\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,YAAY,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,uCACA"}},
    {"offset": {"line": 1649, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1654, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1659, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1664, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/user-message.tsx"],"sourcesContent":["import React from 'react'\nimport { ChatShare } from './chat-share'\n\ntype UserMessageProps = {\n  message: string\n  chatId?: string\n  showShare?: boolean\n}\n\nexport const UserMessage: React.FC<UserMessageProps> = ({\n  message,\n  chatId,\n  showShare = false\n}) => {\n  const enableShare = process.env.ENABLE_SHARE === 'true'\n  return (\n    <div className=\"flex items-center w-full space-x-1 mt-2 min-h-10\">\n      <div className=\"text-xl flex-1 break-words w-full\">{message}</div>\n      {enableShare && showShare && chatId && <ChatShare chatId={chatId} />}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;;;;AASO,MAAM,cAA0C,CAAC,EACtD,OAAO,EACP,MAAM,EACN,YAAY,KAAK,EAClB;IACC,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY,KAAK;IACjD,qBACE,wPAAC;QAAI,WAAU;;0BACb,wPAAC;gBAAI,WAAU;0BAAqC;;;;;;YACnD,eAAe,aAAa,wBAAU,wPAAC,4HAAA,CAAA,YAAS;gBAAC,QAAQ;;;;;;;;;;;;AAGhE"}},
    {"offset": {"line": 1699, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1704, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/copilot-display.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const CopilotDisplay = registerClientReference(\n    function() { throw new Error(\"Attempted to call CopilotDisplay() from the server but CopilotDisplay is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/copilot-display.tsx\",\n    \"CopilotDisplay\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,iBAAiB,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,4CACA"}},
    {"offset": {"line": 1713, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1718, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1723, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1728, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/components/error-card.tsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const ErrorCard = registerClientReference(\n    function() { throw new Error(\"Attempted to call ErrorCard() from the server but ErrorCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/error-card.tsx\",\n    \"ErrorCard\",\n);\n"],"names":[],"mappings":";;;;;;AACO,MAAM,YAAY,CAAA,GAAA,+PAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,uCACA"}},
    {"offset": {"line": 1737, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1742, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1747, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1752, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/actions.tsx"],"sourcesContent":["import {\n  StreamableValue,\n  createAI,\n  createStreamableUI,\n  createStreamableValue,\n  getAIState,\n  getMutableAIState\n} from 'ai/rsc'\nimport { CoreMessage, generateId, ToolResultPart } from 'ai'\nimport { Spinner } from '@/components/ui/spinner'\nimport { Section } from '@/components/section'\nimport { FollowupPanel } from '@/components/followup-panel'\nimport { inquire, researcher, taskManager, querySuggestor } from '@/lib/agents'\nimport { writer } from '@/lib/agents/writer'\nimport { saveChat } from '@/lib/actions/chat'\nimport { Chat } from '@/lib/types'\nimport { AIMessage } from '@/lib/types'\nimport { UserMessage } from '@/components/user-message'\nimport { SearchSection } from '@/components/search-section'\nimport SearchRelated from '@/components/search-related'\nimport { CopilotDisplay } from '@/components/copilot-display'\nimport RetrieveSection from '@/components/retrieve-section'\nimport { VideoSearchSection } from '@/components/video-search-section'\nimport { transformToolMessages } from '@/lib/utils'\nimport { AnswerSection } from '@/components/answer-section'\nimport { ErrorCard } from '@/components/error-card'\n\nasync function submit(\n  formData?: FormData,\n  skip?: boolean,\n  retryMessages?: AIMessage[]\n) {\n  'use server'\n\n  const aiState = getMutableAIState<typeof AI>()\n  const uiStream = createStreamableUI()\n  const isGenerating = createStreamableValue(true)\n  const isCollapsed = createStreamableValue(false)\n\n  const aiMessages = [...(retryMessages ?? aiState.get().messages)]\n  // Get the messages from the state, filter out the tool messages\n  const messages: CoreMessage[] = aiMessages\n    .filter(\n      message =>\n        message.role !== 'tool' &&\n        message.type !== 'followup' &&\n        message.type !== 'related' &&\n        message.type !== 'end'\n    )\n    .map(message => {\n      const { role, content } = message\n      return { role, content } as CoreMessage\n    })\n\n  // groupId is used to group the messages for collapse\n  const groupId = generateId()\n\n  const useSpecificAPI = process.env.USE_SPECIFIC_API_FOR_WRITER === 'true'\n  const useOllamaProvider = !!(\n    process.env.OLLAMA_MODEL && process.env.OLLAMA_BASE_URL\n  )\n  const maxMessages = useSpecificAPI ? 5 : useOllamaProvider ? 1 : 10\n  // Limit the number of messages to the maximum\n  messages.splice(0, Math.max(messages.length - maxMessages, 0))\n  // Get the user input from the form data\n  const userInput = skip\n    ? `{\"action\": \"skip\"}`\n    : (formData?.get('input') as string)\n\n  const content = skip\n    ? userInput\n    : formData\n    ? JSON.stringify(Object.fromEntries(formData))\n    : null\n  const type = skip\n    ? undefined\n    : formData?.has('input')\n    ? 'input'\n    : formData?.has('related_query')\n    ? 'input_related'\n    : 'inquiry'\n\n  // Add the user message to the state\n  if (content) {\n    aiState.update({\n      ...aiState.get(),\n      messages: [\n        ...aiState.get().messages,\n        {\n          id: generateId(),\n          role: 'user',\n          content,\n          type\n        }\n      ]\n    })\n    messages.push({\n      role: 'user',\n      content\n    })\n  }\n\n  async function processEvents() {\n    // Show the spinner\n    uiStream.append(<Spinner />)\n\n    let action = { object: { next: 'proceed' } }\n    // If the user skips the task, we proceed to the search\n    if (!skip) action = (await taskManager(messages)) ?? action\n\n    if (action.object.next === 'inquire') {\n      // Generate inquiry\n      const inquiry = await inquire(uiStream, messages)\n      uiStream.done()\n      isGenerating.done()\n      isCollapsed.done(false)\n      aiState.done({\n        ...aiState.get(),\n        messages: [\n          ...aiState.get().messages,\n          {\n            id: generateId(),\n            role: 'assistant',\n            content: `inquiry: ${inquiry?.question}`,\n            type: 'inquiry'\n          }\n        ]\n      })\n      return\n    }\n\n    // Set the collapsed state to true\n    isCollapsed.done(true)\n\n    //  Generate the answer\n    let answer = ''\n    let stopReason = ''\n    let toolOutputs: ToolResultPart[] = []\n    let errorOccurred = false\n\n    const streamText = createStreamableValue<string>()\n\n    // If ANTHROPIC_API_KEY is set, update the UI with the answer\n    // If not, update the UI with a div\n    if (process.env.ANTHROPIC_API_KEY) {\n      uiStream.update(\n        <AnswerSection result={streamText.value} hasHeader={false} />\n      )\n    } else {\n      uiStream.update(<div />)\n    }\n\n    // If useSpecificAPI is enabled, only function calls will be made\n    // If not using a tool, this model generates the answer\n    while (\n      useSpecificAPI\n        ? toolOutputs.length === 0 && answer.length === 0 && !errorOccurred\n        : (stopReason !== 'stop' || answer.length === 0) && !errorOccurred\n    ) {\n      // Search the web and generate the answer\n      const { fullResponse, hasError, toolResponses, finishReason } =\n        await researcher(uiStream, streamText, messages)\n      stopReason = finishReason || ''\n      answer = fullResponse\n      toolOutputs = toolResponses\n      errorOccurred = hasError\n\n      if (toolOutputs.length > 0) {\n        toolOutputs.map(output => {\n          aiState.update({\n            ...aiState.get(),\n            messages: [\n              ...aiState.get().messages,\n              {\n                id: groupId,\n                role: 'tool',\n                content: JSON.stringify(output.result),\n                name: output.toolName,\n                type: 'tool'\n              }\n            ]\n          })\n        })\n      }\n    }\n\n    // If useSpecificAPI is enabled, generate the answer using the specific model\n    if (useSpecificAPI && answer.length === 0 && !errorOccurred) {\n      // modify the messages to be used by the specific model\n      const modifiedMessages = transformToolMessages(messages)\n      const latestMessages = modifiedMessages.slice(maxMessages * -1)\n      const { response, hasError } = await writer(uiStream, latestMessages)\n      answer = response\n      errorOccurred = hasError\n      messages.push({\n        role: 'assistant',\n        content: answer\n      })\n    }\n\n    if (!errorOccurred) {\n      const useGoogleProvider = process.env.GOOGLE_GENERATIVE_AI_API_KEY\n      const useOllamaProvider = !!(\n        process.env.OLLAMA_MODEL && process.env.OLLAMA_BASE_URL\n      )\n      let processedMessages = messages\n      // If using Google provider, we need to modify the messages\n      if (useGoogleProvider) {\n        processedMessages = transformToolMessages(messages)\n      }\n      if (useOllamaProvider) {\n        processedMessages = [{ role: 'assistant', content: answer }]\n      }\n\n      streamText.done()\n      aiState.update({\n        ...aiState.get(),\n        messages: [\n          ...aiState.get().messages,\n          {\n            id: groupId,\n            role: 'assistant',\n            content: answer,\n            type: 'answer'\n          }\n        ]\n      })\n\n      // Generate related queries\n      const relatedQueries = await querySuggestor(uiStream, processedMessages)\n      // Add follow-up panel\n      uiStream.append(\n        <Section title=\"Follow-up\">\n          <FollowupPanel />\n        </Section>\n      )\n\n      aiState.done({\n        ...aiState.get(),\n        messages: [\n          ...aiState.get().messages,\n          {\n            id: groupId,\n            role: 'assistant',\n            content: JSON.stringify(relatedQueries),\n            type: 'related'\n          },\n          {\n            id: groupId,\n            role: 'assistant',\n            content: 'followup',\n            type: 'followup'\n          }\n        ]\n      })\n    } else {\n      aiState.done(aiState.get())\n      streamText.done()\n      uiStream.append(\n        <ErrorCard\n          errorMessage={answer || 'An error occurred. Please try again.'}\n        />\n      )\n    }\n\n    isGenerating.done(false)\n    uiStream.done()\n  }\n\n  processEvents()\n\n  return {\n    id: generateId(),\n    isGenerating: isGenerating.value,\n    component: uiStream.value,\n    isCollapsed: isCollapsed.value\n  }\n}\n\nexport type AIState = {\n  messages: AIMessage[]\n  chatId: string\n  isSharePage?: boolean\n}\n\nexport type UIState = {\n  id: string\n  component: React.ReactNode\n  isGenerating?: StreamableValue<boolean>\n  isCollapsed?: StreamableValue<boolean>\n}[]\n\nconst initialAIState: AIState = {\n  chatId: generateId(),\n  messages: []\n}\n\nconst initialUIState: UIState = []\n\n// AI is a provider you wrap your application with so you can access AI and UI state in your components.\nexport const AI = createAI<AIState, UIState>({\n  actions: {\n    submit\n  },\n  initialUIState,\n  initialAIState,\n  onGetUIState: async () => {\n    'use server'\n\n    const aiState = getAIState()\n    if (aiState) {\n      const uiState = getUIStateFromAIState(aiState as Chat)\n      return uiState\n    } else {\n      return\n    }\n  },\n  onSetAIState: async ({ state, done }) => {\n    'use server'\n\n    // Check if there is any message of type 'answer' in the state messages\n    if (!state.messages.some(e => e.type === 'answer')) {\n      return\n    }\n\n    const { chatId, messages } = state\n    const createdAt = new Date()\n    const userId = 'anonymous'\n    const path = `/search/${chatId}`\n    const title =\n      messages.length > 0\n        ? JSON.parse(messages[0].content)?.input?.substring(0, 100) ||\n          'Untitled'\n        : 'Untitled'\n    // Add an 'end' message at the end to determine if the history needs to be reloaded\n    const updatedMessages: AIMessage[] = [\n      ...messages,\n      {\n        id: generateId(),\n        role: 'assistant',\n        content: `end`,\n        type: 'end'\n      }\n    ]\n\n    const chat: Chat = {\n      id: chatId,\n      createdAt,\n      userId,\n      path,\n      title,\n      messages: updatedMessages\n    }\n    await saveChat(chat)\n  }\n})\n\nexport const getUIStateFromAIState = (aiState: Chat) => {\n  const chatId = aiState.chatId\n  const isSharePage = aiState.isSharePage\n  return aiState.messages\n    .map((message, index) => {\n      const { role, content, id, type, name } = message\n\n      if (\n        !type ||\n        type === 'end' ||\n        (isSharePage && type === 'related') ||\n        (isSharePage && type === 'followup')\n      )\n        return null\n\n      switch (role) {\n        case 'user':\n          switch (type) {\n            case 'input':\n            case 'input_related':\n              const json = JSON.parse(content)\n              const value = type === 'input' ? json.input : json.related_query\n              return {\n                id,\n                component: (\n                  <UserMessage\n                    message={value}\n                    chatId={chatId}\n                    showShare={index === 0 && !isSharePage}\n                  />\n                )\n              }\n            case 'inquiry':\n              return {\n                id,\n                component: <CopilotDisplay content={content} />\n              }\n          }\n        case 'assistant':\n          const answer = createStreamableValue()\n          answer.done(content)\n          switch (type) {\n            case 'answer':\n              return {\n                id,\n                component: <AnswerSection result={answer.value} />\n              }\n            case 'related':\n              const relatedQueries = createStreamableValue()\n              relatedQueries.done(JSON.parse(content))\n              return {\n                id,\n                component: (\n                  <SearchRelated relatedQueries={relatedQueries.value} />\n                )\n              }\n            case 'followup':\n              return {\n                id,\n                component: (\n                  <Section title=\"Follow-up\" className=\"pb-8\">\n                    <FollowupPanel />\n                  </Section>\n                )\n              }\n          }\n        case 'tool':\n          try {\n            const toolOutput = JSON.parse(content)\n            const isCollapsed = createStreamableValue()\n            isCollapsed.done(true)\n            const searchResults = createStreamableValue()\n            searchResults.done(JSON.stringify(toolOutput))\n            switch (name) {\n              case 'search':\n                return {\n                  id,\n                  component: <SearchSection result={searchResults.value} />,\n                  isCollapsed: isCollapsed.value\n                }\n              case 'retrieve':\n                return {\n                  id,\n                  component: <RetrieveSection data={toolOutput} />,\n                  isCollapsed: isCollapsed.value\n                }\n              case 'videoSearch':\n                return {\n                  id,\n                  component: (\n                    <VideoSearchSection result={searchResults.value} />\n                  ),\n                  isCollapsed: isCollapsed.value\n                }\n            }\n          } catch (error) {\n            return {\n              id,\n              component: null\n            }\n          }\n        default:\n          return {\n            id,\n            component: null\n          }\n      }\n    })\n    .filter(message => message !== null) as UIState\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2230, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2235, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/search/[id]/page.tsx"],"sourcesContent":["import { notFound, redirect } from 'next/navigation'\nimport { Chat } from '@/components/chat'\nimport { getChat } from '@/lib/actions/chat'\nimport { AI } from '@/app/actions'\n\nexport const maxDuration = 60\n\nexport interface SearchPageProps {\n  params: {\n    id: string\n  }\n}\n\nexport async function generateMetadata({ params }: SearchPageProps) {\n  const chat = await getChat(params.id, 'anonymous')\n  return {\n    title: chat?.title.toString().slice(0, 50) || 'Search'\n  }\n}\n\nexport default async function SearchPage({ params }: SearchPageProps) {\n  const userId = 'anonymous'\n  const chat = await getChat(params.id, userId)\n\n  if (!chat) {\n    redirect('/')\n  }\n\n  if (chat?.userId !== userId) {\n    notFound()\n  }\n\n  return (\n    <AI\n      initialAIState={{\n        chatId: chat.id,\n        messages: chat.messages\n      }}\n    >\n      <Chat id={params.id} />\n    </AI>\n  )\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAKO,MAAM,cAAc;AAQpB,eAAe,iBAAiB,EAAE,MAAM,EAAmB;IAChE,MAAM,OAAO,MAAM,CAAA,GAAA,sHAAA,CAAA,UAAO,AAAD,EAAE,OAAO,EAAE,EAAE;IACtC,OAAO;QACL,OAAO,MAAM,MAAM,WAAW,MAAM,GAAG,OAAO;IAChD;AACF;AAEe,eAAe,WAAW,EAAE,MAAM,EAAmB;IAClE,MAAM,SAAS;IACf,MAAM,OAAO,MAAM,CAAA,GAAA,sHAAA,CAAA,UAAO,AAAD,EAAE,OAAO,EAAE,EAAE;IAEtC,IAAI,CAAC,MAAM;QACT,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;IACX;IAEA,IAAI,MAAM,WAAW,QAAQ;QAC3B,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD;IACT;IAEA,qBACE,wPAAC,+GAAA,CAAA,KAAE;QACD,gBAAgB;YACd,QAAQ,KAAK,EAAE;YACf,UAAU,KAAK,QAAQ;QACzB;kBAEA,cAAA,wPAAC,mHAAA,CAAA,OAAI;YAAC,IAAI,OAAO,EAAE;;;;;;;;;;;AAGzB"}},
    {"offset": {"line": 2286, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2302, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/favicon.ico.mjs (structured image object)"],"sourcesContent":["import src from \"IMAGE\";\nexport default { src, width: 32, height: 32 }\n"],"names":[],"mappings":";;;;;;uCACe;IAAE,KAAA,2GAAA,CAAA,UAAG;IAAE,OAAO;IAAI,QAAQ;AAAG"}},
    {"offset": {"line": 2313, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2322, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/opengraph-image.png.mjs (structured image object)"],"sourcesContent":["import src from \"IMAGE\";\nexport default { src, width: 1200, height: 627 }\n"],"names":[],"mappings":";;;;;;uCACe;IAAE,KAAA,sHAAA,CAAA,UAAG;IAAE,OAAO;IAAM,QAAQ;AAAI"}},
    {"offset": {"line": 2333, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}